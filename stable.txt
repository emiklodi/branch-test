this is the stable version of the code